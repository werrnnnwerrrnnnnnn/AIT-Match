<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Profile Page</title>
  <!-- CSS -->
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #FDEDF1; /* Ensure the body background color is consistent */
    }

    .profile-container {
      display: flex;
      align-items: flex-start;
      padding: 50px;
      background-color: #FDEDF1; /* Match background to body */
      margin-top: 40px;
      margin-bottom: 100px;
      max-width: 1200px;
      margin-left: auto;
      margin-right: auto;
      gap: 20px;
    }

    .profile-card, .academic-info, .preferences-container {
      background-color: #fff; /* Ensure sections have a solid background */
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .profile-card {
      width: 300px;
      padding: 30px;
      text-align: center;
    }

    .profile-picture {
      border-radius: 50%;
      margin-bottom: 20px;
    }

    .profile-card h2 {
      margin-bottom: 10px;
    }

    .profile-card table {
      width: 100%;
      margin-bottom: 20px;
      border-collapse: collapse;
    }

    .profile-card table td {
      padding: 8px 0;
    }

    .profile-card table td:first-child {
      font-weight: bold;
      text-align: right;
      padding-right: 10px;
    }

    .profile-card table td:last-child {
      text-align: left;
    }

    .profile-card .btn {
      display: inline-block;
      padding: 10px 20px;
      margin: 5px;
      font-size: 14px;
      font-weight: bold;
      text-align: center;
      text-decoration: none;
      border-radius: 50px;
      background-color: #617952;
      color: white;
      border: none;
      cursor: pointer;
      transition: transform 0.3s ease, background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
    }

    .profile-card .btn:hover {
      background-color: #4a5c41;
    }

    .right-column {
      display: flex;
      flex-direction: column;
      flex: 1;
      gap: 20px;
    }

    .academic-info, .preferences-container {
      padding: 20px;
    }

    .academic-info h3, .preferences-container h3 {
      color: #617952;
      margin-bottom: 20px;
    }

    .badge {
      display: inline-block;
      padding: 10px 15px;
      border-radius: 20px;
      background-color: #f3f3f3;
      margin: 5px 5px 0 0;
      font-size: 14px;
      color: #333;
      border: 1px solid #ddd;
    }

    .badge-emoji {
      margin-right: 8px;
    }

    .preferences-section, .interests-section {
      margin-bottom: 20px;
    }

    .preferences-container .section-content {
      display: flex;
      flex-wrap: wrap;
    }

    .no-data {
      color: #666;
    }

    /* Back button styling with bounce animation */
    .btn-back {
      background-color: #4a5c41;
      color: #fff;
      font-weight: bold;
      font-size: 15px;
      border-radius: 50px;
      padding: 10px 20px;
      border: none;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      transition: transform 0.3s ease, background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
      margin-top: 20px;
    }

    .btn-back:hover {
      background-color: #3b4a32;
      color: #fff;
      transform: translateY(-5px);
      box-shadow: 0px 6px 8px rgba(0, 0, 0, 0.2);
    }

    /* Report button styling with the exact bounce animation */
    .report-btn {
      background-color: #d9534f;
      color: white;
      font-weight: bold;
      font-size: 15px;
      border-radius: 50px;
      padding: 10px 20px;
      border: none;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      transition: transform 0.3s ease, background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
    }

    .report-btn:hover {
      background-color: #c9302c;
      color: white;
      transform: translateY(-5px);
      box-shadow: 0px 6px 8px rgba(0, 0, 0, 0.2);
    }

    /* Ensure consistent backgrounds */
    .academic-info, .preferences-container {
      width: 100%;
      background-color: #fff;
    }

  </style>
</head>
<body>
  <!-- HTML -->
  <div class="profile-container">
    <!-- Left Side: Profile Information -->
    <div class="profile-card">
        <% if @profile.profile_picture.attached? %>
            <%= image_tag @profile.profile_picture, alt: 'Profile Picture', class: 'profile-picture', size: '120x120' %>
        <% else %>
            <%= image_tag 'default-profile-picture.png', alt: 'Default Profile Picture', class: 'profile-picture', size: '120x120' %>
        <% end %>

      <h2><%= @profile.first_name %> <%= @profile.last_name %></h2>

      <table>
        <tr>
          <td><strong>Role:</strong></td>
          <td><%= @user.role %></td>
        </tr>
        <tr>
          <td><strong>Name:</strong></td>
          <td><%= @profile.first_name %> <%= @profile.last_name %></td>
        </tr>
        <tr>
          <td><strong>Username:</strong></td>
          <td><%= @profile.user_name %></td>
        </tr>
        <tr>
          <td><strong>Email:</strong></td>
          <td><%= @user.email %></td>
        </tr>
        <tr>
          <td><strong>Birthday:</strong></td>
          <td><%= @profile.birthday.present? ? @profile.birthday.strftime('%d %m %Y') : "Not provided" %></td>
        </tr>
        <tr>
          <td><strong>Age:</strong></td>
          <td><%= @profile.age %></td>
        </tr>
        <tr>
          <td><strong>Gender:</strong></td>
          <td><%= @profile.gender.label %></td>
        </tr>
        <tr>
          <td><strong>MBTI:</strong></td>
          <td><%= @profile.mbti.combined_value_label %></td>
        </tr>
      </table>

      <!-- Buttons for Back, Report, and Edit -->
      <div>
        <%= link_to 'Back', current_user.admin? ? admin_users_path : profiles_path, class: "btn btn-back" %>
        <% if @profile.user != current_user && !current_user.admin? %>
            <%= link_to 'Report', new_report_path(reported_profile_id: @profile.id), class: 'report-btn' %>
        <% end %>
        <% if @profile.user == current_user %>
            <%= link_to 'Edit Profile', edit_profile_path(@profile), class: "btn" %>
        <% end %>
      </div>
    </div>

    <!-- Right Side: Academic Info and Preferences -->
    <div class="right-column">
      <!-- Academic Information Section -->
      <div class="academic-info">
        <h3>Academic Information:</h3>
        <p><strong>Degree:</strong> <%= @profile.degree.label %></p>
        <p><strong>School:</strong> <%= @profile.program.combined_name_abbreviation %></p>
        <p><strong>Program:</strong> <%= @profile.school.combined_name_abbreviation %></p>
        <p><strong>Educational Background:</strong></p>
        <p><%= @profile.educational_background %></p>
      </div>

      <!-- Preferences and Interests Container -->
      <div class="preferences-container">
        <h3>Preferences and Interests</h3>
        <!-- Preferences Section -->
        <div class="preferences-section">
          <h4>Preferences</h4>
          <% if @profile.relationships.any? %>
            <div class="section-content">
              <% @profile.relationships.each do |relationship| %>
                <span class="badge"><span class="badge-emoji">ðŸ’‘</span><%= relationship.name %></span>
              <% end %>
            </div>
          <% else %>
            <p class="no-data">No preferences provided.</p>
          <% end %>
        </div>

        <!-- Interests Section -->
        <div class="interests-section">
          <h4>Interests</h4>
          <% if @interests.any? %>
            <div class="section-content">
              <% @interests.each do |interest| %>
                <span class="badge"><span class="badge-emoji">ðŸŽ¨</span><%= interest.name %></span>
              <% end %>
            </div>
          <% else %>
            <p class="no-data">No interests selected.</p>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
